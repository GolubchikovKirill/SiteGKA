# ── InfraScope Configuration ──────────────────────────
# Copy this file to .env and adjust values for your environment.

PROJECT_NAME=InfraScope
ENVIRONMENT=production

# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=CHANGE_ME

# ── PostgreSQL ────────────────────────────────────────
POSTGRES_SERVER=db
POSTGRES_PORT=5432
POSTGRES_USER=infrascope
POSTGRES_PASSWORD=CHANGE_ME
POSTGRES_DB=infrascope

# ── First Admin User ─────────────────────────────────
FIRST_SUPERUSER_EMAIL=admin@infrascope.dev
FIRST_SUPERUSER_PASSWORD=CHANGE_ME

# ── Redis ─────────────────────────────────────────────
REDIS_URL=redis://redis:6379/0
WORKER_CONCURRENCY=4
WORKER_POOL=threads
WORKER_METRICS_PORT=9108
ML_ENABLED=true
ML_SERVICE_URL=http://ml-service:8010
POLLING_SERVICE_ENABLED=true
POLLING_SERVICE_URL=http://polling-service:8011
DISCOVERY_SERVICE_ENABLED=true
DISCOVERY_SERVICE_URL=http://discovery-service:8012
NETWORK_CONTROL_SERVICE_ENABLED=true
NETWORK_CONTROL_SERVICE_URL=http://network-control-service:8013
INTERNAL_SERVICE_TOKEN=
KAFKA_ENABLED=true
KAFKA_BOOTSTRAP_SERVERS=kafka:9092
KAFKA_EVENT_TOPIC=infrascope.events
OTEL_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=http://jaeger:4318/v1/traces
OTEL_SERVICE_NAMESPACE=infrascope
ML_MIN_TRAIN_ROWS=50
ML_RETRAIN_HOUR_UTC=2
ML_SCORE_INTERVAL_MINUTES=30

# ── DNS ──────────────────────────────────────────────
# Local DNS server for resolving Windows hostnames inside Docker.
# Usually your default gateway / AD DNS server.
# Find with: ipconfig /all (Windows) or cat /etc/resolv.conf (Linux)
DNS_SERVER=

# ── Network Scanner ──────────────────────────────────
# Subnets to scan (comma-separated CIDR, e.g. 10.10.98.0/24, 10.10.99.0/24)
SCAN_SUBNET=
# Comma-separated list of ports to probe
SCAN_PORTS=9100,631,80,443
# Safety/efficiency limits for network scan
SCAN_MAX_HOSTS=4096
SCAN_TCP_TIMEOUT=1.0
SCAN_TCP_RETRIES=1
SCAN_TCP_CONCURRENCY=256
POLL_JITTER_MAX_MS=150
POLL_OFFLINE_CONFIRMATIONS=2
POLL_CIRCUIT_FAILURE_THRESHOLD=4
POLL_CIRCUIT_OPEN_SECONDS=45
POLL_RESILIENCE_STATE_TTL_SECONDS=7200

# ── Domain ────────────────────────────────────────────
# Local domain name (add to /etc/hosts: 127.0.0.1 infrascope.local)
DOMAIN=infrascope.local

# ── Network Access ───────────────────────────────────
# IP of the host machine (for SSL certificate SAN and CORS).
# Set this to allow access from other computers on the LAN.
# Find with: ipconfig (Windows) or ip addr (Linux)
HOST_IP=

# ── CORS ──────────────────────────────────────────────
# Add https://<HOST_IP> if you want LAN access
BACKEND_CORS_ORIGINS=["https://infrascope.local","https://localhost","http://infrascope.local","http://localhost"]

# ── Frontend ──────────────────────────────────────────
FRONTEND_PORT=80

# ── Monitoring (Prometheus/Grafana) ───────────────────
# Bind to localhost by default; expose publicly only behind VPN/reverse proxy.
PROMETHEUS_BIND=127.0.0.1
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION=15d
PROMETHEUS_IMAGE=prom/prometheus:latest
GRAFANA_BIND=127.0.0.1
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_IMAGE=grafana/grafana-oss:latest
KAFKA_UI_BIND=127.0.0.1
KAFKA_UI_PORT=8080
JAEGER_BIND=127.0.0.1
JAEGER_PORT=16686
